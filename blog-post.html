<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog Post</title>
  <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>

  <main>
    <article class="blog-post">
      <header>
        <div class="blog-meta">
          <p class="blog-category"><!-- Category will be inserted here --></p>
          <span class="dot"></span>
          <time datetime=""><!-- Date will be inserted here --></time>
        </div>
        <h1 class="h2 article-title"><!-- Title will be inserted here --></h1>
      </header>

      <figure class="blog-banner">
        <img src="" alt="" loading="lazy">
      </figure>

      <div class="blog-content">
        <!-- Markdown content will be converted and inserted here -->
      </div>
    </article>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    // Function to get URL parameters
    function getUrlParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    // Load and render markdown content
    async function loadBlogPost() {
      const postId = getUrlParam('post');
      if (!postId) return;

      try {
        console.log('Loading post:', postId);
        const response = await fetch(`./posts/${postId}.json`);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const post = await response.json();
        
        // Update metadata
        document.title = post.metadata.title;
        document.querySelector('.article-title').textContent = post.metadata.title;
        document.querySelector('.blog-category').textContent = post.metadata.category;
        document.querySelector('time').textContent = post.metadata.date;
        document.querySelector('time').setAttribute('datetime', post.metadata.date);
        
        if (post.metadata.image) {
          const img = document.querySelector('.blog-banner img');
          img.src = post.metadata.image;
          img.alt = post.metadata.title;
        }

        // Render markdown content
        document.querySelector('.blog-content').innerHTML = marked.parse(post.content);

      } catch (error) {
        console.error('Error loading blog post:', error);
        document.querySelector('.blog-content').innerHTML = `
          <div class="error">
            <h2>Error loading blog post</h2>
            <p>Sorry, we couldn't load the blog post. Please try again later.</p>
            <pre>${error.message}</pre>
          </div>
        `;
      }
    }

    // Wait for marked to load
    if (typeof marked !== 'undefined') {
      loadBlogPost();
    } else {
      window.addEventListener('load', loadBlogPost);
    }
  </script>
</body>
</html> 